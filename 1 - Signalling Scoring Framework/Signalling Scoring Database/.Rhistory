mothTotal
bartlett.test(mothTotal)
bartlett.test(bodywingTotal)
mothTotal <- table(forewingTotal, hindwingTotal, bodyTotal, forewingBody, hindwingBody,  bodywingTotal & totalMothProbability)
mothTotal
hindwingc <- table(xor(hindwingSpots, mothBodyStripes), hindwingProbablyWarning)
print(hindwingc)
hindwingOneProbably <- chisq.test(hindwingc)
hindwingOneProbably$expected
hindwingOneProbably$observed
hindwingc
hindwingOneProbably
mothTotal <- table(forewingSpots & hindwingSpots & mothBodyStripes, totalMothProbability)
chisq.test(mothTotal)
Totala <- chisq.test(mothTotal)
Totala$expected
Totala$observed
chisq.test(forewingTotal)
both <- forewingTotal | hindwingTotal & bodyTotal
sum(both)
both <- (forewingTotal | hindwingTotal) & bodyTotal
sum(both)
both <- forewingTotal | hindwingTotal & bodyTotal
sum(both)
both <- (forewingTotal | hindwingTotal) & bodyTotal
sum(both)
both <- (forewingTotal | hindwingTotal) & bodyTotal
Moths$both = both
View(Moths)
both <- forewingTotal | hindwingTotal & bodyTotal
Moths$both = both
both <- (forewingTotal | hindwingTotal) & bodyTotal
sum(both)
bodywingTotal <- (forewingTotal | hindwingTotal) & bodyTotal
wingTotal <- forewingTotal | hindwingTotal
location <- ifelse(wingTotal & !bodyTotal, "Wing",
ifelse(!wingTotal & bodyTotal, "Body",
ifelse(!wingTotal & !bodyTotal, "Neither", "Both")))
location
summary(location)
table(location)
Moths$location
Moths$location <- location
View(Moths)
head(bodyTotal)
bodyTotal <- mothBodyStripes & totalMothProbability
sum(bodyTotal)
wingTotal <- forewingTotal | hindwingTotal
wingTotal
summary(wingTotal)
wingTotal <- forewingTotal | hindwingTotal
bodyTotal <- mothBodyStripes & totalMothProbability
sum(bodyTotal)
forewingBody <- forewingTotal & bodyTotal
sum(forewingBody)
wingTotal <- forewingTotal | hindwingTotal
sum(wingTotal)
location <- ifelse(wingTotal & !bodyTotal, "Wing",
ifelse(!wingTotal & bodyTotal, "Body",
ifelse(!wingTotal & !bodyTotal, "Neither", "Both")))
location(Head)
head(location)
summary(location)
sum(location$wing)
wingOnly <- wingTotal | &!bodyTotal
wingOnly <- wingTotal & !bodyTotal
sum(wingOnly)
sum(bodywingTotal)
sum(wingTotal)
sum(wingOnly)
sum(wingOnly)
wingOnly <- wingTotal & !mothBodyStripes
sum(wingOnly)
sum(hindwingBody)
sum(bodyTotal)
dorsalc <- table(xor(dorsalWingSpots, butterflyBodyStripes), dorsalProbablyWarning)
print(dorsalc)
library("Durga")
library(readxl)
#Formatting - Combined Row 1 and Row 2 to create unambiguous column names
mothHeadings <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", n_max = 1, .name_repair = "minimal")
Moths <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", skip = 1)
butterflyHeadings <- read_excel("butterfly_data_Vito_CJI.xlsx", n_max = 1, .name_repair = "minimal")
Butterflies <- read_excel("butterfly_data_Vito_CJI.xlsx", skip = 1)
##A loop that fills each blank space with the content before it in the top rows
mothHeaders <- names(mothHeadings)
for (i in seq_along(mothHeaders)) {
if (mothHeaders[i] == "") {
mothHeaders[i] <- mothHeaders[i-1]
}
}
names(Moths) <- paste(mothHeaders, mothHeadings)
butterflyHeaders <- names(butterflyHeadings)
for (i in seq_along(butterflyHeaders)) {
if (butterflyHeaders[i] == "") {
butterflyHeaders[i] <- butterflyHeaders[i-1]
}
}
names(Butterflies) <- paste(butterflyHeaders, butterflyHeadings)
#Allocating Forewing Spots and Body Stripes
#Moth allocation
forewingSpots <- Moths$`Forewing Pattern` %in% c("patches", "dots", "spots")
hindwingSpots <- Moths$`Hindwing Pattern` %in% c("patches", "dots", "spots")
mothBodyStripes <- Moths$`Body Abdomen pattern` %in% c("vertical stripes",  "horizontal stripes")
forewingHighWarning <- Moths$`Forewing Warning Colour Score` == 5
hindwingHighWarning <- Moths$`Hindwing Warning Colour Score` == 5
#Butterfly allocation - Females only as most likely to be warning coloured over males
ventralWingSpots <- Butterflies$`Ventral side Female Pattern` %in% c("patches", "dots", "spots")
dorsalWingSpots <- Butterflies$`Dorsal Side Female Pattern` %in% c("patches", "dots", "spots")
butterflyBodyStripes <- Butterflies$`Body Female Abdomen pattern` %in% c("vertical stripes", "horizontal stripes")
ventralHighWarning <- Butterflies$`Ventral side Female Warning Colour Score` == 5
dorsalHighWarning <- Butterflies$`Dorsal Side Female Warning Colour Score` == 5
#Question 1, how many moths and butterflies are highly like to be warning coloured
#Warning colours = Forewing and ventral
sum(forewingHighWarning)
#Question 1, how many moths and butterflies are highly like to be warning coloured
#Warning colours = Forewing and ventral
sum(forewingSpots & forewingHighWarning)
#Question 1, how many moths and butterflies are highly like to be warning coloured
#Warning colours = Forewing and ventral
#Moths 52
sum(forewingHighWarning)
sum(ventralHighWarning)
sum(ventralHighWarning)
ventralHighWarning <- Butterflies$`Ventral side Female Warning Colour Score` == 5
sum(ventralHighWarning)
view(ventralHighWarning)
View(Butterflies)
ventralProbablyWarning <- Butterflies$`Ventral side Female Warning Colour Score` >=4
ventralHighWarning <- Butterflies$`Ventral side Female Warning Colour Score` == 5
dorsalProbablyWarning <- Butterflies$`Dorsal Side Female Warning Colour Score` >= 4
dorsalHighWarning <- Butterflies$`Dorsal Side Female Warning Colour Score` == 5
sum(ventralHighWarning)
#Question 1, how many moths and butterflies are highly like to be warning coloured
#Warning colours = Forewing and ventral
#Moths 52
sum(forewingHighWarning)
ventralWingTotal <- ventralWingSpots & ventralProbablyWarning
ventralWingTotal
sum(ventralWingTotal)
ventralHighTotal <- ventralWingSpots & ventralHighWarning
sum(ventralHighTotal)
sum(ventralHighWarning)
sum(ventralHighTotal)
sum(forewingProbablyWarning)
sum(ventralHighTotal)
forewingHighTotal <- forewingSpots & forewingHighWarning
sum(forewingHighTotal)
#Question 2. Where are these signals found
forewingOnlyLocation <- forewingHighTotal & !moth
#Question 2. Where are these signals found
forewingOnlyLocation <- forewingHighTotal & !mothBodyStripes
sum(forewingOnlyLocation)
forewingBoth <- forewingHighTotal & mothBodyStripes
sum(forewingBoth)
ventralOnlyLocation <- ventralHighTotal & !butterflyBodyStripes
sum(ventralOnlyLocation)
ventralBoth <- ventralHighTotal & butterflyBodyStripes
sum(ventralBoth)
#Question 2. Where are these signals found
forewingOnlyLocation <- forewingHighTotal & !mothBodyStripes
sum(forewingOnlyLocation)
ventralOnlyLocation <- ventralHighTotal & !butterflyBodyStripes
sum(ventralOnlyLocation)
ventralBoth <- ventralHighTotal & butterflyBodyStripes
sum(ventralBoth)
view(ventralBoth)
library("Durga")
library(readxl)
#Formatting - Combined Row 1 and Row 2 to create unambiguous column names
mothHeadings <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", n_max = 1, .name_repair = "minimal")
Moths <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", skip = 1)
butterflyHeadings <- read_excel("butterfly_data_Vito_CJI.xlsx", n_max = 1, .name_repair = "minimal")
Butterflies <- read_excel("butterfly_data_Vito_CJI.xlsx", skip = 1)
##A loop that fills each blank space with the content before it in the top rows
mothHeaders <- names(mothHeadings)
for (i in seq_along(mothHeaders)) {
if (mothHeaders[i] == "") {
mothHeaders[i] <- mothHeaders[i-1]
}
}
names(Moths) <- paste(mothHeaders, mothHeadings)
butterflyHeaders <- names(butterflyHeadings)
for (i in seq_along(butterflyHeaders)) {
if (butterflyHeaders[i] == "") {
butterflyHeaders[i] <- butterflyHeaders[i-1]
}
}
names(Butterflies) <- paste(butterflyHeaders, butterflyHeadings)
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts)
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts)
forewingCounts <- table(Moths$`Forewing Warning Colour Score`)
barplot(forewingCounts)
library("Durga")
library(readxl)
#Formatting - Combined Row 1 and Row 2 to create unambiguous column names
mothHeadings <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", n_max = 1, .name_repair = "minimal")
Moths <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", skip = 1)
butterflyHeadings <- read_excel("butterfly_data_Vito_CJI.xlsx", n_max = 1, .name_repair = "minimal")
Butterflies <- read_excel("butterfly_data_Vito_CJI.xlsx", skip = 1)
##A loop that fills each blank space with the content before it in the top rows
mothHeaders <- names(mothHeadings)
for (i in seq_along(mothHeaders)) {
if (mothHeaders[i] == "") {
mothHeaders[i] <- mothHeaders[i-1]
}
}
names(Moths) <- paste(mothHeaders, mothHeadings)
butterflyHeaders <- names(butterflyHeadings)
for (i in seq_along(butterflyHeaders)) {
if (butterflyHeaders[i] == "") {
butterflyHeaders[i] <- butterflyHeaders[i-1]
}
}
names(Butterflies) <- paste(butterflyHeaders, butterflyHeadings)
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts)
barplot(forewingCounts)
barplot(ventralCounts)
barplot(dorsalCounts)
barplot(ventralCounts, main = "Ventral")
barplot(dorsalCounts, main = "Dorsal")
barplot(hindwingCount, main = " Hindwings")
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
barplot(forewingCounts, main = "Forewings")
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts, main = "Ventral")
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts, main = "Dorsal")
barplot(forewingCounts, main = "Forewings")
summary(ventralCounts)
head(ventralCounts)
barplot(ventralCounts, main = "Ventral")
head(dorsalCounts)
head(forewingCounts)
head(hindwingCounts)
barplot(forewingCounts, main = "Forewings")
head(forewingCounts)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
head(hindwingCounts)
forewingCounts <- table(Moths$`Forewing Warning Colour Score`)
barplot(forewingCounts, main = "Forewings")
head(forewingCounts)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
head(hindwingCounts)
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts, main = "Ventral")
head(ventralCounts)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts, main = "Dorsal")
head(dorsalCounts)
forewingCounts <- table(Moths$`Forewing Warning Colour Score`)
barplot(forewingCounts, main = "Forewings")
head(forewingCounts)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
head(hindwingCounts)
head(forewingCounts)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
head(hindwingCounts)
barplot(forewingCounts, main = "Forewings")
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings")
head(hindwingCounts)
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts, main = "Ventral")
head(ventralCounts)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts, main = "Dorsal")
head(dorsalCounts)
#Bar graphs
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts, main = "Ventral")
head(ventralCounts)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts, main = "Dorsal")
head(dorsalCounts)
#Bar graphs
col <- c(0 = "grey", 1 = "#fff000", 2 = "#ffcc00", 3 = "#ff9900", 4 = "#ff6600", 5 = "#ff3300")
#Bar graphs
col <- c("0" = "grey", "1" = "#fff000", "2" = "#ffcc00", "3" = "#ff9900", ""4" = "#ff6600", 5 = "#ff3300")
#Bar graphs
col <- c(0 = "grey", 1 = "#fff000", 2 = "#ffcc00", 3 = "#ff9900", 4 = "#ff6600", 5 = "#ff3300")
barplot(ventralCounts, main = "Ventral", col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
head(dorsalCounts)
forewingCounts <- table(Moths$`Forewing Warning Colour Score`)
barplot(forewingCounts, main = "Forewings", col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300")))
head(forewingCounts)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, main = " Hindwings", col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300")))
head(hindwingCounts)
barplot(dorsalCounts, main = "Dorsal", col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
png(filename = "Figure 2.png", width = pageWidthLarge, height = pageHeightLarge
, units = "in", pointsize = 20,  res = 1000, type = "cairo")
library("Durga")
library(readxl)
##Formatting - Combined Row 1 and Row 2 to create unambiguous column names
mothHeadings <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", n_max = 1, .name_repair = "minimal")
Moths <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", skip = 1)
butterflyHeadings <- read_excel("butterfly_data_Vito_CJI.xlsx", n_max = 1, .name_repair = "minimal")
Butterflies <- read_excel("butterfly_data_Vito_CJI.xlsx", skip = 1)
#Formatting - A loop that fills each blank space with the content before it in the top rows
mothHeaders <- names(mothHeadings)
for (i in seq_along(mothHeaders)) {
if (mothHeaders[i] == "") {
mothHeaders[i] <- mothHeaders[i-1]
}
}
names(Moths) <- paste(mothHeaders, mothHeadings)
butterflyHeaders <- names(butterflyHeadings)
for (i in seq_along(butterflyHeaders)) {
if (butterflyHeaders[i] == "") {
butterflyHeaders[i] <- butterflyHeaders[i-1]
}
}
names(Butterflies) <- paste(butterflyHeaders, butterflyHeadings)
##Defining "Wing signals" and "Body signals"
#Moth allocation
forewingSpots <- Moths$`Forewing Pattern` %in% c("patches", "dots", "spots")
hindwingSpots <- Moths$`Hindwing Pattern` %in% c("patches", "dots", "spots")
mothBodyStripes <- Moths$`Body Abdomen pattern` %in% c("vertical stripes",  "horizontal stripes")
#We will only include signals that score a 5 on the database, as that is most likely to be warning coloured
forewingHighWarning <- Moths$`Forewing Warning Colour Score` == 5
hindwingHighWarning <- Moths$`Hindwing Warning Colour Score` == 5
#Butterfly allocation
ventralWingSpots <- Butterflies$`Ventral side Female Pattern` %in% c("patches", "dots", "spots")
dorsalWingSpots <- Butterflies$`Dorsal Side Female Pattern` %in% c("patches", "dots", "spots")
butterflyBodyStripes <- Butterflies$`Body Female Abdomen pattern` %in% c("vertical stripes", "horizontal stripes")
ventralHighWarning <- Butterflies$`Ventral side Female Warning Colour Score` == 5
dorsalHighWarning <- Butterflies$`Dorsal Side Female Warning Colour Score` == 5
#Question 1. How many moths are warning coloured? (4-5)
totalMothProbability <- forewingProbablyWarning | hindwingProbablyWarning
#Question 2. Where on the wing are they? Hindwing and forewing and body. This utilises probably warning (4-5)
forewingTotal <- forewingSpots & forewingProbablyWarning
sum(forewingTotal)
hindwingTotal <- hindwingSpots & hindwingProbablyWarning
sum(hindwingTotal)
bodyTotal <- mothBodyStripes & totalMothProbability
sum(bodyTotal)
forewingBody <- forewingTotal & bodyTotal
sum(forewingBody)
hindwingBody <- hindwingTotal & bodyTotal
sum(hindwingBody)
bodywingTotal <- (forewingTotal | hindwingTotal) & bodyTotal
sum(bodywingTotal)
wingTotal <- forewingTotal | hindwingTotal
wingOnly <- wingTotal & !mothBodyStripes
sum(wingOnly)
location <- ifelse(wingTotal & !bodyTotal, "Wing",
ifelse(!wingTotal & bodyTotal, "Body",
ifelse(!wingTotal & !bodyTotal, "Neither", "Both")))
Moths$location <- location
forewingHighTotal <- forewingSpots & forewingHighWarning
forewingHighTotal <- forewingSpots & forewingHighWarning
sum(forewingHighTotal)
ventralHighTotal <- ventralWingSpots & ventralHighWarning
#Question 2. Where are these signals found
forewingOnlyLocation <- forewingHighTotal & !mothBodyStripes
sum(forewingOnlyLocation)
forewingBoth <- forewingHighTotal & mothBodyStripes
sum(forewingBoth)
ventralOnlyLocation <- ventralHighTotal & !butterflyBodyStripes
sum(ventralOnlyLocation)
ventralBoth <- ventralHighTotal & butterflyBodyStripes
sum(ventralBoth)
view(ventralBoth)
library("Durga")
library(readxl)
##Formatting - Combined Row 1 and Row 2 to create unambiguous column names
mothHeadings <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", n_max = 1, .name_repair = "minimal")
Moths <- read_excel("Signalling Scoring Moths VitoCJI.xlsx", skip = 1)
butterflyHeadings <- read_excel("butterfly_data_Vito_CJI.xlsx", n_max = 1, .name_repair = "minimal")
Butterflies <- read_excel("butterfly_data_Vito_CJI.xlsx", skip = 1)
#Formatting - A loop that fills each blank space with the content before it in the top rows
mothHeaders <- names(mothHeadings)
for (i in seq_along(mothHeaders)) {
if (mothHeaders[i] == "") {
mothHeaders[i] <- mothHeaders[i-1]
}
}
names(Moths) <- paste(mothHeaders, mothHeadings)
butterflyHeaders <- names(butterflyHeadings)
for (i in seq_along(butterflyHeaders)) {
if (butterflyHeaders[i] == "") {
butterflyHeaders[i] <- butterflyHeaders[i-1]
}
}
names(Butterflies) <- paste(butterflyHeaders, butterflyHeadings)
#Graphing Figure 1 - four bar graphs of each signalling score for the dorsal and ventral side of butterflies, and the forewing and hindwing of moths
pageWidthLarge <- 12
pageHeightLarge <- 8
pagePaper <- 'special'
png(filename = "Figure 2.png", width = pageWidthLarge, height = pageHeightLarge
, units = "in", pointsize = 20,  res = 1000, type = "cairo")
layout(matrix(c(1,2,3, 4), nrow = 2, ncol = 2, byrow = TRUE))
par(mar = c(5,4,2,2)+0.1)
forewingCounts <- table(Moths$`Forewing Warning Colour Score`)
barplot(forewingCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("A", side = 3, line = 0.5, cex = 1, adj = 0.05)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("B", side = 3, line = 0.5, cex = 1, adj = 0.05)
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("C", side = 3, line = 0.5, cex = 1, adj = 0.05)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("D", side = 3, line = 0.5, cex = 1, adj = 0.05)
dev.off()
##Defining "Wing signals" and "Body signals"
#Moth allocation
forewingSpots <- Moths$`Forewing Pattern` %in% c("patches", "dots", "spots")
hindwingSpots <- Moths$`Hindwing Pattern` %in% c("patches", "dots", "spots")
mothBodyStripes <- Moths$`Body Abdomen pattern` %in% c("vertical stripes",  "horizontal stripes")
#We will only include signals that score a 5 on the database, as that is most likely to be warning coloured
forewingHighWarning <- Moths$`Forewing Warning Colour Score` == 5
hindwingHighWarning <- Moths$`Hindwing Warning Colour Score` == 5
#Butterfly allocation
ventralWingSpots <- Butterflies$`Ventral side Female Pattern` %in% c("patches", "dots", "spots")
dorsalWingSpots <- Butterflies$`Dorsal Side Female Pattern` %in% c("patches", "dots", "spots")
butterflyBodyStripes <- Butterflies$`Body Female Abdomen pattern` %in% c("vertical stripes", "horizontal stripes")
ventralHighWarning <- Butterflies$`Ventral side Female Warning Colour Score` == 5
dorsalHighWarning <- Butterflies$`Dorsal Side Female Warning Colour Score` == 5
###This next section creates logical arguments to pull the data needed for the analysis. Necessary definitions are as follows:
## Warning Coloured Moth - If a 5 is scored on the forewing of the species
## Warning Coloured Butterfly - If a 5 is scored on the ventral side of the species
## All statistical analyses (chi- square tests) were completed in vassar stats (http://vassarstats.net/tab2x2.html)
#Question 1, how many moths and butterflies are highly like to be warning coloured
forewingHighTotal <- forewingSpots & forewingHighWarning
sum(forewingHighTotal)
ventralHighTotal <- ventralWingSpots & ventralHighWarning
sum(ventralHighTotal)
#Moths = 52
#Butterflies = 95
#Question 2. Where are these signals found
forewingOnlyLocation <- forewingHighTotal & !mothBodyStripes
sum(forewingOnlyLocation)
forewingBoth <- forewingHighTotal & mothBodyStripes
sum(forewingBoth)
#Moths forewings only - 30
#Moths both forewings and abdomen - 22
ventralOnlyLocation <- ventralHighTotal & !butterflyBodyStripes
sum(ventralOnlyLocation)
ventralBoth <- ventralHighTotal & butterflyBodyStripes
sum(ventralBoth)
#Butterflies wings only - 65
#Butterflies wings and abdomen - 30
dev.off()
library("Durga")
library(readxl)
##Formatting - Combined Row 1 and Row 2 to create unambiguous column names
mothHeadings <- read_excel("moth_data.xlsx", n_max = 1, .name_repair = "minimal")
Moths <- read_excel("moth_data.xlsx", skip = 1)
butterflyHeadings <- read_excel("butterfly_data.xlsx", n_max = 1, .name_repair = "minimal")
Butterflies <- read_excel("butterfly_data.xlsx", skip = 1)
#Formatting - A loop that fills each blank space with the content before it in the top rows
mothHeaders <- names(mothHeadings)
for (i in seq_along(mothHeaders)) {
if (mothHeaders[i] == "") {
mothHeaders[i] <- mothHeaders[i-1]
}
}
names(Moths) <- paste(mothHeaders, mothHeadings)
butterflyHeaders <- names(butterflyHeadings)
for (i in seq_along(butterflyHeaders)) {
if (butterflyHeaders[i] == "") {
butterflyHeaders[i] <- butterflyHeaders[i-1]
}
}
names(Butterflies) <- paste(butterflyHeaders, butterflyHeadings)
#Graphing Figure 1 - four bar graphs of each signalling score for the dorsal and ventral side of butterflies, and the forewing and hindwing of moths
pageWidthLarge <- 12
pageHeightLarge <- 8
pagePaper <- 'special'
png(filename = "Figure 1.png", width = pageWidthLarge, height = pageHeightLarge
, units = "in", pointsize = 20,  res = 1000, type = "cairo")
layout(matrix(c(1,2,3, 4), nrow = 2, ncol = 2, byrow = TRUE))
par(mar = c(5,4,2,2)+0.1)
forewingCounts <- table(Moths$`Forewing Warning Colour Score`)
barplot(forewingCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("A", side = 3, line = 0.5, cex = 1, adj = 0.05)
hindwingCounts <- table(Moths$`Hindwing Warning Colour Score`)
barplot(hindwingCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("B", side = 3, line = 0.5, cex = 1, adj = 0.05)
ventralCounts <- table(Butterflies$`Ventral side Female Warning Colour Score`)
barplot(ventralCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("C", side = 3, line = 0.5, cex = 1, adj = 0.05)
dorsalCounts <- table(Butterflies$`Dorsal Side Female Warning Colour Score`)
barplot(dorsalCounts, col = c("grey", "#fff000", "#ffcc00", "#ff9900", "#ff6600", "#ff3300"))
mtext("D", side = 3, line = 0.5, cex = 1, adj = 0.05)
dev.off()
dev.off()
